ç‚¹å‡»è¿”å›[ğŸ”—æˆ‘çš„åšå®¢æ–‡ç« ç›®å½•](https://percheung.github.io/#/toc)
* ç›®å½•
{:toc}
# Javaè™šæ‹Ÿæœºè®²è§£

## æœ¬æ–‡è®²è§£çš„åè¯æœ‰ï¼ŒJVMï¼Œç¨‹åºè®¡æ•°å™¨ï¼Œæ ˆï¼Œå †ï¼Œæ–¹æ³•åŒºï¼Œå¹¸å­˜åŒºï¼Œå…ƒç©ºé—´ï¼Œæ°¸ä¹…ä»£ï¼Œè€å¹´ä»£ï¼Œæ–°ç”Ÿä»£ï¼Œä¼Šç”¸å›­åŒºï¼Œå¸¸é‡æ± ç­‰ç­‰ã€‚

## ä»€ä¹ˆæ˜¯JVMï¼Ÿ

JVMæ˜¯Java Virtual Machineï¼ˆJavaè™šæ‹Ÿæœºï¼‰çš„ç¼©å†™ï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªä¸“é—¨è¿è¡Œ.javaæ–‡ä»¶çš„å¾®å‹æ“ä½œç³»ç»Ÿã€‚
## æœ‰ä¸‰ç§JVMï¼ˆä¸æ­¢ï¼‰ï¼Œæœ¬æ–‡ä¸»è¦æ¢è®¨jdk8ç‰ˆæœ¬çš„HotSpot

> ä¾‹å¦‚ï¼š
> 1. SUNå…¬å¸çš„Hotspot 
> 2. BEAå…¬å¸çš„JRockit 
> 3. IBMå…¬å¸çš„J9

## JREã€JDKå’ŒJVMçš„å…³ç³»

JDKï¼ˆJava Development Kitï¼ŒJavaå¼€å‘å·¥å…·åŒ…ï¼‰> JREï¼ˆJava Runtime Environmentï¼Œ Javaè¿è¡Œç¯å¢ƒï¼‰> JVMï¼ˆJava Virtual Machineï¼Œ Javaè™šæ‹Ÿæœºï¼‰
## JVMçš„ä¸»è¦ç»„æˆéƒ¨åˆ†

ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰
è¿â¾æ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰
æ‰§â¾å¼•æ“ï¼ˆExecution Engineï¼‰
æœ¬åœ°åº“æ¥â¼ï¼ˆNative Interfaceï¼‰
## JVMæ‰§è¡Œç¨‹åº

â¾¸å…ˆé€šè¿‡ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ä¼šæŠŠ java ä»£ç è½¬æ¢æˆå­—èŠ‚ç ï¼Œè¿â¾æ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰å†æŠŠå­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œâ½½å­—èŠ‚ç â½‚ä»¶åªæ˜¯ jvm çš„â¼€å¥—æŒ‡ä»¤é›†è§„èŒƒï¼Œå¹¶ä¸èƒ½ç›´æ¥äº¤ç»™åº•å±‚æ“ä½œç³»ç»Ÿå»æ‰§â¾ï¼Œå› æ­¤éœ€è¦ç‰¹å®šçš„å‘½ä»¤è§£æå™¨æ‰§â¾å¼•æ“ï¼ˆExecution Engineï¼‰ï¼Œå°†å­—èŠ‚ç ç¿»è¯‘æˆåº•å±‚ç³»ç»ŸæŒ‡ä»¤ï¼Œå†äº¤ç”± CPU å»æ‰§â¾ï¼Œâ½½è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦è°ƒâ½¤å…¶ä»–è¯­â¾”çš„æœ¬åœ°åº“æ¥â¼ï¼ˆNative Interfaceï¼‰æ¥å®ç°æ•´ä¸ªç¨‹åºçš„åŠŸèƒ½ã€‚
## JVM å†…å­˜åˆ’åˆ†ï¼ˆé‡ç‚¹æ¥äº†ï¼‰

### é¦–å…ˆï¼ŒJVM æŒ‰ç…§çº¿ç¨‹æ˜¯å¦å…±äº«å°†å†…å­˜é¦–å…ˆåˆ†æˆä¸¤å¤§ç±»
#### çº¿ç¨‹ç‹¬äº«åŒº
> è¿™é‡Œé¢å°±æ”¾ç€
>  1. ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ 
>  2. Java è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰
>  3. æœ¬åœ°â½…æ³•æ ˆï¼ˆNative Method Stackï¼‰

å®é™…ä¸Šï¼Œæˆ‘ä»¬æ‰€è¯´çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ ˆï¼Œåœ¨jvmä¸­ä»æ¥å°±ä¸æ­¢ä¸€ä¸ªï¼Œçº¿ç¨‹æœ‰å‡ ä¸ªå®ƒå°±æœ‰å‡ ä¸ªã€‚

#### çº¿ç¨‹å…±äº«åŒº
æˆ‘ä»¬æ‰€è¯´çš„GCåƒåœ¾å›æ”¶ï¼ŒJVMè°ƒä¼˜ï¼Œéƒ½æ˜¯åœ¨å †é‡Œã€‚
> è¿™é‡Œé¢å°±æ”¾ç€
>  1. Java å †ï¼ˆJava Heapï¼‰ 
>  2. â½…æ³•åŒºï¼ˆMethed Areaï¼‰ 

æœ‰æ„æ€çš„çŸ¥è¯†ç‚¹æ˜¯ï¼Œæ–¹æ³•åŒºä¹Ÿç§°ä¹‹ä¸º**éå †**ï¼ˆé€»è¾‘ä¸Šæ˜¯å †ï¼Œä½†ç‰©ç†ä¸Šä¸å±äºå †ï¼‰ã€‚ä¸€ä¸ªjvmçš„å †ï¼ˆæ–¹æ³•åŒºä¹Ÿå¯ä»¥è¯´å±äºå †ï¼‰å°±åªæœ‰ä¸€ä¸ªï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½åœ¨å †é‡Œæ‰¾æ•°æ®ã€‚
#### å›¾è§£å¦‚ä¸‹
![850669eba8454a11a7bfa9b8f28cc131](https://percheung.github.io/blogImg/202401031624456.png)
### OKï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥å¾€ä¸‹è§£å‰–è¿™äº”å¤§åŒºåŸŸ
> - ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ï¼šå½“å‰çº¿ç¨‹æ‰€æ‰§â¾çš„å­—èŠ‚ç çš„â¾å·æŒ‡ç¤ºå™¨ï¼Œå­—èŠ‚ç è§£æå™¨çš„â¼¯ä½œæ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼ï¼Œæ¥é€‰å–ä¸‹â¼€æ¡éœ€è¦æ‰§â¾çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†â½€ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½ï¼Œéƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆï¼›
> - Java è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰ï¼šâ½¤äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€â½…æ³•å‡ºâ¼ç­‰ä¿¡æ¯ï¼›
> - æœ¬åœ°â½…æ³•æ ˆï¼ˆNative Method Stackï¼‰ï¼šä¸è™šæ‹Ÿæœºæ ˆçš„ä½œâ½¤æ˜¯â¼€æ ·çš„ï¼Œåªä¸è¿‡è™šæ‹Ÿæœºæ ˆæ˜¯æœåŠ¡ java â½…æ³•çš„ï¼Œâ½½æœ¬åœ°â½…æ³•æ ˆæ˜¯ä¸ºè™šæ‹Ÿæœºè°ƒâ½¤ Native â½…æ³•æœåŠ¡çš„ï¼›
> - Java å †ï¼ˆJava Heapï¼‰ï¼šjava è™šæ‹Ÿæœºä¸­å†…å­˜æœ€â¼¤çš„â¼€å—ï¼Œæ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ï¼Œâ¼ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™â¾¥åˆ†é…å†…å­˜ï¼›
> - â½…æ³•åŒºï¼ˆMethed Areaï¼‰ï¼šâ½¤äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚

#### ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰

> ç”¨äºè®°å½•ä¸‹ä¸€æ¡jvmæŒ‡ä»¤çš„æ‰§è¡Œåœ°å€ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸ã€çº¿ç¨‹æ¢å¤ç­‰éƒ½ä¾èµ–äºè®¡æ•°å™¨ã€‚
> 1. çº¿ç¨‹ç§æœ‰ã€‚
> 2. ä¸ä¼šå­˜åœ¨å†…å­˜æº¢å‡ºã€‚
#### Java è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰
> æ ˆä¸­ä¿å­˜åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼å’Œå¯¹è±¡ä»¥åŠåŸºç¡€æ•°æ®çš„å¼•ç”¨ã€‚
> 1. åŸºæœ¬æ•°æ®ç±»å‹ï¼šå˜é‡åœ¨å£°æ˜çš„æ—¶å€™ï¼Œèƒ½å¤Ÿç¡®è®¤å ç”¨å†…å­˜çš„å¤§å°ã€‚
> 2. å¼•ç”¨æ•°æ®ç±»å‹ï¼šå¼•ç”¨æ•°æ®ç±»å‹å°†å€¼çš„å¼•ç”¨å­˜æ”¾åˆ°è™šæ‹Ÿæœºæ ˆä¸­ï¼Œè€Œå¯¹è±¡å­˜æ”¾åœ¨å †å†…å­˜ä¸­ï¼Œå¼•ç”¨æ•°æ®ç±»å‹å ç”¨ 8ä¸ªå­—èŠ‚å­˜æ”¾åœ°å€ï¼ˆ64ä½jvmè™šæ‹Ÿæœºï¼Œå³æˆ‘ä»¬jdk8 64ä½ç‰ˆæœ¬çš„Hotspotï¼‰ã€‚

##### æ ˆå¸§

> æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ä¼šå¯¹åº”ä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œçº¿ç¨‹ä¸­çš„æ¯ä¸ªæ–¹æ³•éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œå­˜æ”¾æœ¬æ¬¡æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„æ‰€æœ‰æ•°æ®ã€‚
> 1. å±€éƒ¨å˜é‡ï¼šå­˜æ”¾å½“å‰æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹å­˜å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹å­˜å †å†…å­˜åœ°å€ã€‚
>
> 2. æ“ä½œæ•°æ ˆï¼šå¯¹æ–¹æ³•ä¸­çš„å˜é‡æä¾›è®¡ç®—çš„åŒºåŸŸã€‚
>
> 3. å¸¸é‡æ•°æ®çš„å¼•ç”¨ï¼šå¸¸é‡æ•°æ®ä¼šå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„å¸¸é‡æ± ä¸­ï¼Œä¸ç®¡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹è¿˜æ˜¯å¼•ç”¨æ•°æ®ç±»å‹éƒ½ä¼šå­˜æ”¾å¸¸é‡ã€‚
>
> 4. æ± çš„åœ°å€ï¼šæ–¹æ³•è¿”å›å€¼çš„åœ°å€ æ–¹æ³•è¿”å›æ•°æ®ä¼šå­˜åˆ°è®¡ç®—æœºå†…å­˜çš„å¯„å­˜å™¨ä¸­ã€‚

##### æ ˆæº¢å‡ºï¼ˆStackOverflowErrorï¼‰

> å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æœ€å¤§æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚

##### è§£å†³æ–¹æ¡ˆï¼ˆæœªå¿…æœ‰ç”¨ï¼‰ï¼š

> å¯ä»¥é€šè¿‡ä¿®æ”¹è™šæ‹Ÿæœºæ ˆçš„å†…å­˜å¤§å°è®¾ç½®æ ˆå¸§çš„æœ€å¤§æ·±åº¦ï¼ŒæŒ‡ä»¤ä¸ºï¼š-Xss ç”¨æ¥ä¿®æ”¹è™šæ‹Ÿæœºæ ˆå†…å­˜å¤§å°

> æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªErrorå¼‚å¸¸ï¼Œæ˜¯éå¸¸ä¸¥é‡çš„ï¼Œè¿™é‡Œåº”è¯¥å»æ£€æŸ¥ä½ ä»£ç æ˜¯ä¸æ˜¯æœ‰é—®é¢˜ã€‚

#### æœ¬åœ°â½…æ³•æ ˆï¼ˆNative Method Stackï¼‰

> ä½œâ½¤äºæœ¬åœ°â½…æ³•æ‰§â¾çš„â¼€å—Javaå†…å­˜åŒºåŸŸï¼Œç”¨æ¥â½€æŒnativeâ½…æ³•æ‰§â¾ï¼Œnativeå…³é”®å­—è¯´æ˜å…¶â½…æ³•æ˜¯ä¸€ä¸ªåŸâ½£æ€æ–¹æ³•ï¼Œæ–¹æ³•å¯¹åº”çš„å®ç°ä¸æ˜¯åœ¨å½“å‰æ–‡ä»¶ï¼Œâ½½æ˜¯åœ¨â½¤å…¶ä»–è¯­â¾”(å¦‚Cå’ŒC++)å®ç°çš„æ–‡ä»¶ä¸­ã€‚è¿™é‡Œé¢å­˜æ”¾ç€è°ƒç”¨æœ¬åœ°æ–¹æ³•çš„æ¥å£ã€‚

####  Java å †ï¼ˆJava Heapï¼‰
##### å£°æ˜ï¼šè¿™é‡Œä»¥jdk8çš„è§†è§’è®²è§£å †ï¼Œæˆ‘åœ¨å†™è¿™ç¯‡ä¹‹å‰ä¸€ç›´åˆ†ä¸æ¸…å¹¸å­˜åŒºï¼Œæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£ï¼Œä¼Šç”¸å›­åŒºï¼ŒæŒä¹…ä»£ï¼Œæ°¸ä¹…ä»£ï¼Œå…ƒç©ºé—´ç­‰ç­‰åè¯ï¼Œè¿™ä¸€ç¯‡çš„ç›®çš„ä¹Ÿåœ¨äºæ¢³ç†è¿™äº›åè¯ï¼Œææ‡‚å®ƒä»¬ã€‚
##### é¦–å…ˆï¼Œå †æœ‰ä¸¤ç§è¯´æ³•ï¼Œç¬¬ä¸€ç§è¯´å †ç­‰äºå †å†…å­˜+æ–¹æ³•åŒºï¼Œç¬¬äºŒç§è¯´æ³•æ–¹æ³•åŒºä¸å±äºå †ï¼Œä¸‹é¢å¼€å§‹å±•å¼€è®²è§£ã€‚
------------
##### ä¸‹é¢çš„å†…å®¹éƒ½æ˜¯æˆ‘æŸ¥çœ‹å¤§é‡èµ„æ–™æ‰€è§çš„ï¼Œå¸Œæœ›å¤§å®¶åšå®šç›¸ä¿¡ï¼
##### okï¼Œæˆ‘ä»¬å…ˆæ¢³ç†è¿™ä¸¤ç§è¯´æ³•ï¼Œçœ‹çœ‹æ˜¯å¦è¦å°†å †å’Œæ–¹æ³•åŒºåˆ†å¼€è®²è§£ï¼
##### å…ƒç©ºé—´
å®é™…ä¸Šä¸ºå¤§å®¶é€ æˆä¸¤ç§å¥‡æ€ªè¯´æ³•åŸå› åœ¨äºï¼Œæ–¹æ³•åŒºåœ¨è®¾è®¡ä¸Šç¡®å®å±äºå †çš„ä¸€éƒ¨åˆ†ï¼Œæ–¹æ³•åŒºå…¶å®å°±æ˜¯å¤§å®¶æ‰€è¯´çš„å…ƒç©ºé—´ï¼Œ**æ²¡é”™ï¼Œå®é™…ä¸Šå¤§å®¶ä¸€ç›´äº‰è®®çš„å…ƒç©ºé—´ï¼Œå°±æ˜¯æ–¹æ³•åŒºï¼Œå…ƒç©ºé—´å°±æ˜¯æ–¹æ³•åŒºçš„å…·ä½“å®ç°ï¼**

æ–¹æ³•åŒºå±äºå †ï¼Œä½†æ˜¯å…ƒç©ºé—´ä¸å±äºå †ï¼Œè¿™ä¹Ÿå°±æ˜¯è‘—åçš„éå †ç†è®ºï¼ˆæ–¹æ³•åŒºé€»è¾‘ä¸Šå±äºå †ï¼Œç‰©ç†ä¸Šä¸å±äºå †ï¼‰ï¼Œ**å †çš„ç©ºé—´ï¼ˆçº¦ä¸ºç³»ç»Ÿå†…å­˜çš„å››åˆ†ä¹‹ä¸€ï¼‰ï¼Œå…ƒç©ºé—´çš„è¢«è®¤ä¸ºæ˜¯æ— é™å¤§ï¼Œå†…å­˜å¤šå¤§å®ƒå°±å¤šå¤§ï¼Œå †åˆæ€ä¹ˆå¯èƒ½æ”¾å¾—ä¸‹å…ƒç©ºé—´ï¼**

**æŒä¹…ä»£**å·²åºŸå¼ƒï¼Œä»¥ååªæœ‰**å…ƒç©ºé—´**ã€‚**ä»ç‰©ç†è§’åº¦æ¥è¯´ï¼Œæ–¹æ³•åŒºä¸å±äºå †**ã€‚

##### è¯´å®Œäº†ç»“è®ºï¼Œæ‰€ä»¥ä¸‹æ–‡å°†æŠŠå †å’Œæ–¹æ³•åŒºåˆ†å¼€ã€‚
---------------
##### å †çš„åˆ’åˆ†
ä»¥ä¸‹çš†ä¸ºç‰©ç†åˆ’åˆ†ï¼Œå¯ä»¥é€šè¿‡ä»£ç å®éªŒã€‚
> å †å¤§å° = å¹´è½»ä»£ + è€å¹´ä»£
> å¹´è½»ä»£ = eden space (æ–°ç”Ÿä»£ï¼Œå®˜æ–¹è¯´æ³•å°±æ˜¯ä¼Šç”¸å›­åŒº) + from survivorï¼ˆæ¥è‡ªå¹¸å­˜åŒºï¼‰ + to survivorï¼ˆå‰å¾€å¹¸å­˜åŒºï¼‰

##### æ¸…æ™°å¯è§
-------------
##### æˆ‘ä»¬åŒ…å«çš„åè¯æœ‰æ–°ç”Ÿä»£ï¼Œè€å¹´ä»£ï¼Œå¹´è½»ä»£ï¼Œä¼Šç”¸å›­åŒºï¼Œå¹¸å­˜åŒºï¼Œå…ƒç©ºé—´ã€‚
##### JVMçº¿ç¨‹å…±äº«åŒº = å † + æ–¹æ³•åŒº
##### å † = å¹´è½»ä»£ + è€å¹´ä»£
##### æ–¹æ³•åŒº = å…ƒç©ºé—´
##### å¹´è½»ä»£ = æ–°ç”Ÿä»£ + å¹¸å­˜åŒº
##### æ–°ç”Ÿä»£ = ä¼Šç”¸å›­åŒº
##### å¹¸å­˜åŒº = formå¹¸å­˜åŒº + toå¹¸å­˜åŒº
--------------

##### æ‰€è°“çš„åƒåœ¾å›æ”¶ï¼Œå°±åœ¨å †é‡Œå¤§é‡è¿›è¡Œï¼Œå¯¹è±¡åœ¨formå¹¸å­˜åŒºå’Œtoå¹¸å­˜åŒºæ¥å›è·³è·ƒï¼Œæ¯æ¥å›ä¸€æ¬¡ï¼Œå¹´é¾„+1ï¼ŒåŠ åˆ°15æ—¶å°±å¯ä»¥è¿›è€å¹´ä»£äº†ã€‚ å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•°-XXï¼šMaxTenuringThresholdè®¾ç½®ã€‚
##### å †æº¢å‡ºOut of Memory

> å †å‚æ•°ï¼ˆ-Xmx ä¸-Xmsï¼‰
#### åƒåœ¾å›æ”¶GCï¼ˆGarbage Collectionï¼‰
> ä¸»è¦ç›®çš„ï¼šé˜²æ­¢å†…å­˜æº¢å‡º Out of Memory
##### åƒåœ¾å›æ”¶ç®—æ³•
> - æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼šæ ‡è®°â½†â½¤å¯¹è±¡ï¼Œç„¶åè¿›â¾æ¸…é™¤å›æ”¶ã€‚ç¼ºç‚¹ï¼šæ•ˆç‡ä¸â¾¼ï¼Œâ½†æ³•æ¸…é™¤åƒåœ¾ç¢â½šã€‚
> - æ ‡è®°-æ•´ç†ç®—æ³•ï¼šæ ‡è®°â½†â½¤å¯¹è±¡ï¼Œè®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘â¼€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…é™¤æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚
> - å¤åˆ¶ç®—æ³•ï¼šæŒ‰ç…§å®¹é‡åˆ’åˆ†â¼†ä¸ªâ¼¤â¼©ç›¸ç­‰çš„å†…å­˜åŒºåŸŸï¼Œå½“â¼€å—â½¤å®Œçš„æ—¶å€™å°†æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦â¼€å—ä¸Šï¼Œç„¶åå†æŠŠå·²ä½¿â½¤çš„å†…å­˜ç©ºé—´â¼€æ¬¡æ¸…ç†æ‰ã€‚ç¼ºç‚¹ï¼šå†…å­˜ä½¿â½¤ç‡ä¸â¾¼ï¼Œåªæœ‰åŸæ¥çš„â¼€åŠã€‚
> - åˆ†ä»£ç®—æ³•ï¼šæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºâ¼å—ï¼Œâ¼€èˆ¬æ˜¯æ–°â½£ä»£å’Œâ½¼å¹´ä»£ï¼Œæ–°â½£ä»£åŸºæœ¬é‡‡â½¤å¤åˆ¶ç®—æ³•ï¼Œâ½¼å¹´ä»£é‡‡â½¤æ ‡è®°æ•´ç†ç®—æ³•ã€‚

#### â½…æ³•åŒºï¼ˆMethed Areaï¼‰ 
##### 1. å…ƒç©ºé—´å°±æ˜¯æ–¹æ³•åŒºçš„å…·ä½“å®ç°
##### 2. å¤§åé¼é¼çš„å¸¸é‡æ± å°±åœ¨æ–¹æ³•åŒºï¼Œä¸è¿‡ï¼ŒJDK8çš„HotSpot VMä¸­ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± åœ¨æ–¹æ³•åŒºï¼Œè€Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«ç§»åˆ°äº†å †ä¸­äº†ã€‚æ­¤æ—¶å¸¸é‡æ± å­˜å‚¨çš„å°±æ˜¯å­—ç¬¦ä¸²çš„å¼•ç”¨äº†ã€‚

> æ–¹æ³•åŒºä¼šå­˜å‚¨ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡ï¼ˆJDK8 ä¹‹åä¸å­˜æ”¾å­—ç¬¦ä¸²å¸¸é‡ï¼‰ã€æœ¬åœ°æœºå™¨æŒ‡ä»¤ã€‚
## JVMè°ƒä¼˜çš„å‚æ•°
> -Xms2g åˆå§‹åŒ–æ¨â¼¤â¼©ä¸º 2gï¼›
> -Xmx2g å †æœ€â¼¤å†…å­˜ä¸º 2gï¼›
> -XX:NewRatio=4 è®¾ç½®å¹´è½»çš„å’Œâ½¼å¹´ä»£çš„å†…å­˜â½ä¾‹ä¸º 1:4ï¼›
> -XX:SurvivorRatio=8 è®¾ç½®æ–°â½£ä»£ Eden å’Œ Survivor â½ä¾‹ä¸º 8:2ï¼›
> -XX:+UseParNewGC æŒ‡å®šä½¿â½¤ ParNew + Serial Old åƒåœ¾å›æ”¶å™¨ç»„åˆï¼›
> -XX:+UseParallelOldGC æŒ‡å®šä½¿â½¤ ParNew + ParNew Old åƒåœ¾å›æ”¶å™¨ç»„åˆï¼›
> -XX:+UseConcMarkSweepGC æŒ‡å®šä½¿â½¤ CMS + Serial Old åƒåœ¾å›æ”¶å™¨ç»„åˆï¼›
> -XX:+PrintGC å¼€å¯æ‰“å°gcä¿¡æ¯ï¼›
> -XX:+PrintGCDetails æ‰“å°gcè¯¦ç»†ä¿¡æ¯ã€‚